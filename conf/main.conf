# base config
set +eu
[ -z $DATE ] && DATE=$(date "+%Y%m%d")
set -eu
log_dir=$work_dir/log
data_dir=$work_dir/data
conf_dir=$work_dir/conf
lib_dir=$work_dir/lib


# hadoop configurations
hadoop_home=/home/yunti/hadoop-current
#hadoop_home=/data/tbalgo/tieyi.lq/hadoop/current
hadoop_exec=$hadoop_home/bin/hadoop

hadoop_exec_conf=""
[ $debug -eq 1 ] && hadoop_exec_conf=/home/tieyi.lq/conf

hadoop_xml=$conf_dir/hadoop.xml
gaya_xml=$conf_dir/gaya.xml


# libjars
main_jar=$work_dir/jar/GaYa.jar
hadoop_tool_jar=$lib_dir/display_tool_0.1.0.jar
protobuf_jar=$lib_dir/protobuf-java-2.4.1.jar
midlog_parser_jar=/home/a/share/display/algo/libs/display_midlog_parser.jar

# input configurations
midlog_home=/group/tbalgo/DiamondLogs
# [ $debug -eq 1 ] && midlog_home=/group/tbalgo-dev/tieyi/DiamondLogs
midlog_input=$midlog_home/$DATE

midad_input=/group/tbalgo/diamond/admidtier/origin/$DATE/result

# local path configurations
combgen_pid=$conf_dir/combgen_pid.conf
cross_pid=$conf_dir/cross_pid.conf
train_pid=$conf_dir/train_pid.conf
ors_pid=$conf_dir/ors_pid.conf
customer_cate=$data_dir/$DATE/customer2cate.txt

# output configurations
out_dir=/group/tbalgo/diamondDSP/gaya
[ $debug -eq 1 ] && out_dir=/group/tbalgo-dev/$testuser/gaya

daily_version=current
model_version=current
stat_version=current
train_version=current
ors_version=current
moniter_version=current
check_version=current

#test
#[ $debug -eq 1 ] && \
#daily_version=test && \
#stat_version=test  && \
#model_version=test && \
#train_version=test && \
#ors_version=test && \
#check_version=test && \
#moniter_version=test

#鏃ュ織澶勭悊鐩稿叧鐨勪笢瑗�matchstat鐩稿叧鐨勪笢涓�daily_prefix=$out_dir/daily/$daily_version
#鏁版嵁绱Н鐩稿叧鐨勪笢涓�stat_prefix=$out_dir/stat/$stat_version
#瀛樻斁涓巑odel鐩稿叧鐨勪笢瑗匡紝濡傜敓鎴恌eature.conf,鐢熸垚model.conf绛夌瓑
model_prefix=$out_dir/model/$model_version
#璁粌鏃剁敤鐨刯oin-match-comb,妯″瀷璁粌鐢ㄧ殑instance
train_prefix=$out_dir/train/$train_version
#棰勬祴鍙婂箍鍛婇�鍙栫浉鍏�ors_prefix=$out_dir/ors/$ors_version
#鐩戞祴鐩稿叧
moniter_prefix=$out_dir/moniter/$moniter_version
#Debug鐩稿叧
check_prefix=$out_dir/check/$check_version

#####log ouput######
bidpv_output=bidpv
pv_output=pv
click_output=click
pvclick_output=pvclick

addata_output=addata
depth_output=depth
ad_output=ad
topmatch_output=topmatch
matchstat_output=matchstat
combstat_output=combstat
dailybuild_moniter_output=moniter
matchcomb_output=matchcomb
matchcomb_output_1=$matchcomb_output.step1
count_output=statfreq
disc_output=discretize
train_output=train
predict_output=predict
score_output=score
grep_output=grep
bidscore_output=bidscore
ors_ad_output=ors_r_adinfo
ors_comb_weight=ors_comb_weight
ors_request_output=ors_request
ors_model=combweight
tdbmcover=tdbmcover

# mpilr configurations

#mpi_pmem=$[90/mpi_ppn]gb

# core configurations
comb_merge_days=14
match_merge_days=14
train_merge_days=14
#join match comb鐨勬椂闂撮棿闅�match_comb_join_inter=1
#use $ days combination to generator feature.conf
num_feature_days=7
#count match use $ days pv锛宑hoose top pv to match ad, then do predict
num_target_days=7
#use $ days matchcomb data to generator train instance
num_train_days=7

# data keep days
daily_keep_days=35
stat_keep_days=28
model_keep_days=7
train_keep_days=15
ors_keep_days=7
check_keep_days=7
log_keep_days=30
data_keep_days=7

#check config
MAX_ECPM=50000

LOG_KEEP_DAYS=30
LOG_LEVEL=ERROR

alarm_file=$work_dir/log/alarm.$DATE
MAIL_ADDRESS_LIST="tieyi.lq@taobao.com,shaoyao@taobao.com,yizi.xfl@taobao.com"
[ $debug -eq 1 ] && MAIL_ADDRESS_LIST="tieyi.lq@taobao.com"

MAIL_SUBJECT="[Ecpm GaYa Job Failed]"
